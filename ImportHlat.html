<script>
    function parseJSON() {
        const raw = document.getElementById('jsonInput').value;
        const listArea = document.getElementById('hlatForm'); // Vùng hiển thị danh sách
        
        try {
            const data = JSON.parse(raw);
            const items = Array.isArray(data) ? data : [data]; // Tự động ép thành mảng nếu chỉ dán 1 hồ sơ
            
            listArea.innerHTML = `<h3 class="font-bold mb-4 text-blue-600 uppercase italic">Danh sách ${items.length} hồ sơ sẵn sàng:</h3>`;
            
            items.forEach((item, index) => {
                listArea.innerHTML += `
                    <div class="bg-white border-2 border-blue-100 p-4 rounded-2xl mb-4 shadow-sm">
                        <div class="flex justify-between items-start mb-2">
                            <span class="bg-blue-600 text-white text-[10px] px-2 py-1 rounded-lg">Hồ sơ #${index + 1}</span>
                            <input type="checkbox" checked class="w-4 h-4">
                        </div>
                        <p class="text-sm font-black text-gray-800">${item.don_vi_de_nghi || "Không tên"}</p>
                        <p class="text-[11px] text-gray-500 mt-1">${item.dia_chi_cong_trinh || "Không địa chỉ"}</p>
                        <div class="grid grid-cols-2 gap-4 mt-3 bg-slate-50 p-2 rounded-xl text-[10px]">
                            <div><b>Thực tế:</b> <span class="text-red-600">${item.dt_hlat_thuc_te}m2</span></div>
                            <div><b>Quy hoạch:</b> <span class="text-red-600">${item.dt_hlat_quy_hoach}m2</span></div>
                        </div>
                    </div>
                `;
            });

            alert(`Đã nhận diện ${items.length} hồ sơ! Anh vui lòng kiểm tra danh sách bên phải.`);
        } catch (e) {
            alert("Lỗi: Mã JSON không đúng định dạng mảng.");
        }
    }
</script>

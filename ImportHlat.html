<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Nhập liệu HLAT từ JSON - v1.2</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        :root { --primary: #0068ff; }
        body { background: #f0f2f5; font-family: -apple-system, sans-serif; }
        .card { background: white; border-radius: 1.5rem; box-shadow: 0 10px 15px -3px rgba(0,0,0,0.1); }
        .form-input { width: 100%; padding: 12px; border: 1px solid #e2e8f0; border-radius: 12px; font-size: 14px; outline: none; transition: all 0.2s; }
        .form-input:focus { border-color: var(--primary); ring: 2px; ring-color: #0068ff20; }
        .label-p { text-[10px] font-black text-gray-400 uppercase ml-1 mb-1; }
    </style>
</head>
<body class="p-4 md:p-10">

    <div class="max-w-5xl mx-auto">
        <header class="mb-8 text-center md:text-left">
            <h1 class="text-3xl font-black text-blue-800 uppercase italic">Import HLAT Tool</h1>
            <p class="text-gray-500 text-sm">Dán mã JSON từ AI để tạo công việc mới vào kho</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            
            <div class="space-y-4">
                <div class="card p-6 border-2 border-blue-100 bg-blue-50/30">
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="font-bold text-blue-700">1. Dán mã JSON vào đây</h3>
                        <button onclick="clearAll()" class="text-[10px] font-bold text-red-500 uppercase">Xóa sạch</button>
                    </div>
                    <textarea id="jsonInput" rows="12" 
                        class="w-full p-4 font-mono text-xs border-2 border-dashed border-blue-200 rounded-2xl outline-none focus:border-blue-500"
                        placeholder='{ "don_vi_de_nghi": "...", "dt_hlat_thuc_te": ... }'></textarea>
                    
                    <button onclick="parseJSON()" class="w-full mt-4 bg-blue-600 text-white font-black py-4 rounded-2xl shadow-lg hover:bg-blue-700 transition active:scale-95">
                        BẮT ĐẦU ĐỔ DỮ LIỆU ➔
                    </button>
                </div>
            </div>

            <div class="card p-6 border-2 border-transparent">
                <h3 class="font-bold text-gray-800 mb-6 uppercase italic border-b pb-2">2. Kiểm tra & Hiệu chỉnh</h3>
                
                <form id="hlatForm" class="space-y-4">
                    <div>
                        <p class="label-p">Đơn vị / Cá nhân đề nghị</p>
                        <input id="f_org" class="form-input font-bold text-blue-900">
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <p class="label-p">Người liên hệ</p>
                            <input id="f_user" class="form-input">
                        </div>
                        <div>
                            <p class="label-p">Số điện thoại</p>
                            <input id="f_phone" class="form-input">
                        </div>
                    </div>

                    <div>
                        <p class="label-p">Địa chỉ công trình</p>
                        <input id="f_addr" class="form-input">
                    </div>

                    <div class="grid grid-cols-2 gap-4 bg-slate-50 p-4 rounded-2xl border">
                        <div>
                            <p class="label-p">DT Thực tế (m2)</p>
                            <input id="f_real" type="number" step="0.1" class="form-input font-black text-red-600">
                        </div>
                        <div>
                            <p class="label-p">DT Quy hoạch (m2)</p>
                            <input id="f_plan" type="number" step="0.1" class="form-input font-black text-red-600">
                        </div>
                    </div>

                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <p class="label-p">Ngày nhận</p>
                            <input id="f_date" type="date" class="form-input">
                        </div>
                        <div>
                            <p class="label-p">Hạn xử lý (10 ngày)</p>
                            <input id="f_deadline" type="date" class="form-input border-red-200 bg-red-50">
                        </div>
                    </div>

                    <button type="button" onclick="saveToPool()" class="w-full bg-green-600 text-white font-black py-4 rounded-2xl shadow-xl hover:bg-green-700 transition mt-4 uppercase">
                        Lưu vào kho công việc
                    </button>
                </form>
            </div>

        </div>
    </div>

    <script>
        function parseJSON() {
            const raw = document.getElementById('jsonInput').value;
            try {
                const data = JSON.parse(raw);
                
                // Đổ dữ liệu vào Form
                document.getElementById('f_org').value = data.don_vi_de_nghi || "";
                document.getElementById('f_user').value = data.nguoi_lien_he || "";
                document.getElementById('f_phone').value = data.so_dien_thoai || "";
                document.getElementById('f_addr').value = data.dia_chi_cong_trinh || "";
                document.getElementById('f_real').value = data.dt_hlat_thuc_te || 0;
                document.getElementById('f_plan').value = data.dt_hlat_quy_hoach || 0;
                document.getElementById('f_date').value = data.ngay_nhan || "";
                document.getElementById('f_deadline').value = data.han_xu_ly || "";

                // Hiệu ứng thông báo thành công
                alert("Đã đổ dữ liệu thành công! Anh vui lòng kiểm tra lại trước khi Lưu.");
            } catch (e) {
                alert("Lỗi mã JSON: Anh hãy kiểm tra xem đã copy đủ dấu ngoặc { } chưa.");
            }
        }

        function clearAll() {
            if(confirm("Xóa toàn bộ nội dung?")) {
                document.getElementById('jsonInput').value = "";
                document.getElementById('hlatForm').reset();
            }
        }

        function saveToPool() {
            const org = document.getElementById('f_org').value;
            if(!org) return alert("Vui lòng dán dữ liệu trước!");
            
            // Logic lưu vào kho (Console log để kiểm tra)
            console.log("Đã gửi công việc vào kho QLLĐ2:", org);
            alert("Công việc '" + org + "' đã được đưa vào kho. Trạng thái: Chờ phân công.");
        }
    </script>
</body>
</html>
